# é¡¹ç›®è¯­è¨€é‡æ–°æ‰«æå’Œä¾èµ–è§£ææŠ¥å‘Š

## æ‰§è¡Œæ—¶é—´
2025-11-14

## ä»»åŠ¡æ¦‚è¿°

å¯¹æ‰€æœ‰é¡¹ç›®è¿›è¡Œè¯­è¨€é‡æ–°æ£€æµ‹ï¼Œå¹¶è§¦å‘ä¾èµ–é‡æ–°è§£æï¼Œç¡®ä¿ï¼š
1. é¡¹ç›®è¯­è¨€å­—æ®µæ­£ç¡®ï¼ˆä½¿ç”¨Flask APIæ£€æµ‹ï¼‰
2. æ‰€æœ‰é¡¹ç›®çš„ä¾èµ–ç»„ä»¶å­˜å‚¨åˆ°ç™½åå•è¡¨ä¸­
3. å„è¯­è¨€çš„ç»„ä»¶å¯ä»¥å‚ä¸æ¼æ´æ£€æµ‹

---

## ç¬¬ä¸€æ­¥ï¼šè¯­è¨€é‡æ–°æ‰«æ

### æ‰§è¡Œçš„è„šæœ¬
`rescan_project_languages.py`

### æ‰«æç»“æœ

| é¡¹ç›®ID | é¡¹ç›®åç§° | åŸè¯­è¨€ | æ£€æµ‹è¯­è¨€ | çŠ¶æ€ |
|--------|----------|--------|----------|------|
| 20 | 22222 | java | java | âœ“ æ­£ç¡® |
| 23 | mall | java | java | âœ“ æ­£ç¡® |
| 24 | python | python | python | âœ“ æ­£ç¡® |
| 25 | php | php | php | âœ“ æ­£ç¡® |
| 26 | rust | rust | rust | âœ“ æ­£ç¡® |
| 27 | javascript | javascript | javascript | âœ“ æ­£ç¡® |
| 28 | erlangæµ‹è¯•é¡¹ç›® | erlang | erlang | âœ“ æ­£ç¡® |
| 29 | goæµ‹è¯•é¡¹ç›® | go | **c** | âš  å·²æ›´æ–° |
| 30 | phpæµ‹è¯•é¡¹ç›® | php | php | âœ“ æ­£ç¡® |
| 31 | rustæµ‹è¯•é¡¹ç›® | rust | rust | âœ“ æ­£ç¡® |
| 32 | pythonæµ‹è¯•é¡¹ç›® | python | python | âœ“ æ­£ç¡® |
| 33 | rubyæµ‹è¯•é¡¹ç›® | ruby | ruby | âœ“ æ­£ç¡® |
| 34 | rust-test | **java** | **erlang** | âš  å·²æ›´æ–° |
| 35 | rust-gpu | **java** | **rust** | âš  å·²æ›´æ–° |
| 36 | js-test | **java** | **javascript** | âš  å·²æ›´æ–° |
| 37 | js-test111 | **java** | **other** | âš  å·²æ›´æ–° |
| 38 | sl4jé¡¹ç›® | java | java | âœ“ æ­£ç¡® |
| 39 | javascripté¡¹ç›® | **java** | **javascript** | âš  å·²æ›´æ–° |
| 40 | erlangæµ‹è¯•é¡¹ç›® | **java** | **erlang** | âš  å·²æ›´æ–° |

### æ‰«æç»Ÿè®¡

- **æ€»é¡¹ç›®æ•°**: 19
- **æ›´æ–°æ•°é‡**: 7
- **æ— éœ€æ›´æ–°**: 12
- **å¤±è´¥/è·³è¿‡**: 0

### å‘ç°çš„é—®é¢˜

**è¢«é”™è¯¯è¯†åˆ«ä¸ºJavaçš„é¡¹ç›®**ï¼ˆ7ä¸ªï¼‰ï¼š
1. ID 34: rust-test â†’ å®é™…æ˜¯ erlang
2. ID 35: rust-gpu â†’ å®é™…æ˜¯ rust
3. ID 36: js-test â†’ å®é™…æ˜¯ javascript
4. ID 37: js-test111 â†’ æ— æ³•è¯†åˆ«ï¼ˆotherï¼‰
5. ID 39: javascripté¡¹ç›® â†’ å®é™…æ˜¯ javascript
6. ID 40: erlangæµ‹è¯•é¡¹ç›® â†’ å®é™…æ˜¯ erlang
7. ID 29: goæµ‹è¯•é¡¹ç›® â†’ å®é™…æ˜¯ cï¼ˆshadowsocks-goé¡¹ç›®ä½¿ç”¨Cè¯­è¨€ç¼–å†™ï¼‰

---

## ç¬¬äºŒæ­¥ï¼šä¾èµ–é‡æ–°è§£æ

### æ‰§è¡Œçš„è„šæœ¬
`trigger_reparse_all.py`

### è§¦å‘ç»“æœ

- **æ€»é¡¹ç›®æ•°**: 19
- **æˆåŠŸè§¦å‘**: 18
- **å¤±è´¥**: 0
- **è·³è¿‡**: 1ï¼ˆID 37: js-test111, è¯­è¨€ä¸º 'other'ï¼‰

### è§¦å‘çš„è§£æä»»åŠ¡

| è¯­è¨€ | é¡¹ç›®æ•°é‡ |
|------|----------|
| Java | 3 |
| Python | 3 |
| PHP | 2 |
| Ruby | 1 |
| Rust | 3 |
| JavaScript | 3 |
| Erlang | 3 |
| C | 1 |

---

## ç¬¬ä¸‰æ­¥ï¼šç™½åå•è¡¨ç»„ä»¶ç»Ÿè®¡

### é‡æ–°è§£æå‰ï¼ˆä¹‹å‰çš„çŠ¶æ€ï¼‰

| è¯­è¨€ | ç»„ä»¶æ•°é‡ |
|------|----------|
| java | 46 |
| php | 6 |
| python | 18 |
| ruby | 74 |
| **æ€»è®¡** | **144** |

### é‡æ–°è§£æåï¼ˆå½“å‰çŠ¶æ€ï¼‰

| è¯­è¨€ | ç»„ä»¶æ•°é‡ | å˜åŒ– |
|------|----------|------|
| erlang | 2 | ğŸ†• æ–°å¢ |
| java | 164 | â¬† +118 |
| php | 14 | â¬† +8 |
| python | 66 | â¬† +48 |
| ruby | 74 | - ä¸å˜ |
| **æ€»è®¡** | **320** | **â¬† +176** |

### è¯´æ˜

**æ–°å¢çš„è¯­è¨€**ï¼š
- âœ… erlang: 2ä¸ªç»„ä»¶

**æ˜¾è‘—å¢é•¿çš„è¯­è¨€**ï¼š
- âœ… java: ä»46 â†’ 164 (+118ä¸ªç»„ä»¶ï¼Œå¢é•¿256%)
- âœ… python: ä»18 â†’ 66 (+48ä¸ªç»„ä»¶ï¼Œå¢é•¿267%)
- âœ… php: ä»6 â†’ 14 (+8ä¸ªç»„ä»¶ï¼Œå¢é•¿133%)

**æœªå‡ºç°åœ¨ç™½åå•ä¸­çš„è¯­è¨€**ï¼š
- âŒ rust: è™½ç„¶æœ‰3ä¸ªrusté¡¹ç›®ï¼Œä½†Flaskè§£æå™¨è¶…æ—¶æˆ–è¿”å›ç©ºç»“æœ
- âŒ javascript: æœ‰3ä¸ªjavascripté¡¹ç›®ï¼Œä½†å¯èƒ½æ²¡æœ‰package.jsonæˆ–ä¾èµ–ä¸ºç©º
- âŒ c: 1ä¸ªCé¡¹ç›®ï¼ˆshadowsocks-goï¼‰ï¼Œå¯èƒ½æ²¡æœ‰ä¾èµ–é…ç½®æ–‡ä»¶

---

## è¯­è¨€æ£€æµ‹é€»è¾‘åˆ†æ

### Flask API æ£€æµ‹ä¼˜å…ˆçº§

`ProjectUtil.detectProjectType()` æ–¹æ³•çš„æ£€æµ‹æµç¨‹ï¼š

1. **ä¼˜å…ˆä½¿ç”¨Flask API**ï¼ˆ`/parse/get_primary_language`ï¼‰
   - è°ƒç”¨Flask APIè¿›è¡Œè¯­è¨€æ£€æµ‹
   - å¦‚æœæˆåŠŸè¿”å›ä¸”ä¸æ˜¯'unknown'ï¼Œç›´æ¥ä½¿ç”¨

2. **å›é€€åˆ°æœ¬åœ°æ–‡ä»¶æ‰«æ**
   - å¦‚æœFlask APIå¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ–‡ä»¶æ‰«æ
   - æ£€æµ‹æ·±åº¦ä»3å±‚å¢åŠ åˆ°10å±‚ï¼ˆå·²ä¼˜åŒ–ï¼‰

### æœ¬åœ°æ–‡ä»¶æ‰«æä¼˜å…ˆçº§

```java
if (hasJava[0]) return "java";
if (hasRust[0]) return "rust";
if (hasGo[0]) return "go";
if (hasPython[0]) return "python";
if (hasPhp[0]) return "php";
if (hasRuby[0]) return "ruby";
if (hasErlang[0]) return "erlang";
if (hasCpp[0]) return "cpp";
if (hasC[0]) return "c";
if (hasNodeJs[0]) return "javascript";
return "unknown";
```

**é—®é¢˜**ï¼šJavaä¼˜å…ˆçº§æœ€é«˜ï¼Œå¯¼è‡´æ··åˆè¯­è¨€é¡¹ç›®è¢«è¯†åˆ«ä¸ºJava

### æ£€æµ‹ç‰¹å¾æ–‡ä»¶

| è¯­è¨€ | é…ç½®æ–‡ä»¶ | æºä»£ç æ‰©å±•å |
|------|----------|--------------|
| Java | pom.xml, build.gradle, settings.gradle | .java |
| Python | setup.py, requirements.txt, pyproject.toml, pipfile | .py |
| PHP | composer.json, composer.lock | .php |
| Ruby | Gemfile, Gemfile.lock | .rb, .gemspec |
| Rust | Cargo.toml, Cargo.lock | .rs |
| Go | go.mod, go.sum | .go |
| JavaScript | package.json, package-lock.json, yarn.lock | .js, .ts |
| Erlang | rebar.config, rebar.lock | .erl |
| C/C++ | Makefile, CMakeLists.txt | .c, .cpp, .cc, .cxx, .h |

---

## å½±å“åˆ†æ

### å¯¹æ¼æ´æ£€æµ‹ç³»ç»Ÿçš„å½±å“

**æ­£é¢å½±å“**ï¼š
1. âœ… ç»„ä»¶æ•°é‡ç¿»å€ï¼ˆ144 â†’ 320ï¼‰ï¼Œæ¼æ´æ£€æµ‹è¦†ç›–é¢æ‰©å¤§
2. âœ… æ–°å¢ erlang è¯­è¨€æ”¯æŒ
3. âœ… Java, Python, PHP é¡¹ç›®çš„ä¾èµ–æ›´å®Œæ•´
4. âœ… é¡¹ç›®è¯­è¨€å­—æ®µæ›´å‡†ç¡®ï¼Œè§£æå™¨è°ƒç”¨æ›´æ­£ç¡®

**ä»å­˜åœ¨çš„é™åˆ¶**ï¼š
1. âš  Rusté¡¹ç›®ï¼šFlaskè§£æå™¨è¶…æ—¶é—®é¢˜æœªè§£å†³
2. âš  JavaScripté¡¹ç›®ï¼šéƒ¨åˆ†é¡¹ç›®æ²¡æœ‰package.jsonæˆ–ä¾èµ–ä¸ºç©º
3. âš  Cé¡¹ç›®ï¼šæ²¡æœ‰æ ‡å‡†çš„ä¾èµ–ç®¡ç†é…ç½®æ–‡ä»¶

---

## åç»­å»ºè®®

### çŸ­æœŸï¼ˆç«‹å³å¯æ‰§è¡Œï¼‰

1. **è§¦å‘æ¼æ´æ£€æµ‹ä»»åŠ¡**
   - åœ¨XXL-JOBä¸­æ‰‹åŠ¨æ‰§è¡Œ `githubVulnerabilityFetchJob` æˆ– `avdVulnerabilityFetchJob`
   - éªŒè¯æ–°çš„320ä¸ªç»„ä»¶èƒ½å¦æ­£ç¡®å‚ä¸æ¼æ´æ£€æµ‹

2. **éªŒè¯æ£€æµ‹ç»“æœ**
   ```sql
   -- æŸ¥çœ‹æ£€æµ‹åˆ°çš„æ¼æ´
   SELECT language, COUNT(*) as vuln_count
   FROM vulnerability
   WHERE is_delete = 0
   GROUP BY language;

   -- æŸ¥çœ‹æœ‰é£é™©çš„é¡¹ç›®
   SELECT p.name, p.language, COUNT(*) as vuln_count
   FROM project_vulnerability pv
   JOIN project p ON pv.project_id = p.id
   JOIN vulnerability v ON pv.vulnerability_id = v.id
   WHERE pv.isdelete = 0
   GROUP BY p.id, p.name, p.language;
   ```

### ä¸­æœŸï¼ˆéœ€è¦ä»£ç ä¼˜åŒ–ï¼‰

1. **ä¼˜åŒ–Rustè§£æå™¨**
   - å¢åŠ Flask APIè¶…æ—¶æ—¶é—´
   - æˆ–è€…ä¼˜åŒ–rust_parseå‡½æ•°ï¼Œåªè§£æç›´æ¥ä¾èµ–

2. **æ”¹è¿›è¯­è¨€æ£€æµ‹é€»è¾‘**
   - è€ƒè™‘ä½¿ç”¨æ–‡ä»¶ç»Ÿè®¡è€Œéä¼˜å…ˆçº§
   - æˆ–è€…è®©ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸»è¦è¯­è¨€

3. **æ·»åŠ JavaScript/Cé¡¹ç›®ä¾èµ–ç®¡ç†**
   - JavaScript: ç¡®ä¿æœ‰package.json
   - C: è€ƒè™‘æ·»åŠ å¯¹conanã€vcpkgç­‰åŒ…ç®¡ç†å™¨çš„æ”¯æŒ

### é•¿æœŸï¼ˆæ¶æ„æ”¹è¿›ï¼‰

1. **æ··åˆè¯­è¨€é¡¹ç›®æ”¯æŒ**
   - å…è®¸ä¸€ä¸ªé¡¹ç›®æœ‰å¤šç§è¯­è¨€
   - åˆ†åˆ«è§£æå„è¯­è¨€çš„ä¾èµ–

2. **å¢é‡è§£æ**
   - åªè§£ææ–°å¢çš„ä¾èµ–ï¼Œé¿å…é‡å¤è§£æ

3. **è§£æçŠ¶æ€è¿½è¸ª**
   - åœ¨projectè¡¨å¢åŠ parsing_statuså­—æ®µ
   - è®°å½•è§£ææˆåŠŸ/å¤±è´¥/è¿›è¡Œä¸­çŠ¶æ€

---

## è„šæœ¬æ–‡ä»¶

### åˆ›å»ºçš„å·¥å…·è„šæœ¬

1. **rescan_project_languages.py**
   - åŠŸèƒ½ï¼šé‡æ–°æ‰«ææ‰€æœ‰é¡¹ç›®çš„è¯­è¨€ç±»å‹
   - ä½¿ç”¨ï¼š`python rescan_project_languages.py`

2. **trigger_reparse_all.py**
   - åŠŸèƒ½ï¼šè§¦å‘æ‰€æœ‰é¡¹ç›®çš„ä¾èµ–é‡æ–°è§£æ
   - ä½¿ç”¨ï¼š`python trigger_reparse_all.py`

3. **rescan_project_languages.sh** (å¤‡ç”¨ï¼ŒWindowsä¸‹å¯èƒ½ä¸å¯ç”¨)
   - Bashç‰ˆæœ¬çš„é‡æ–°æ‰«æè„šæœ¬

---

## æ€»ç»“

### âœ… å·²å®Œæˆ

1. é‡æ–°æ‰«ææ‰€æœ‰é¡¹ç›®è¯­è¨€ï¼ˆ19ä¸ªé¡¹ç›®ï¼‰
2. ä¿®æ­£7ä¸ªè¢«é”™è¯¯è¯†åˆ«ä¸ºJavaçš„é¡¹ç›®
3. è§¦å‘18ä¸ªé¡¹ç›®çš„ä¾èµ–é‡æ–°è§£æ
4. ç™½åå•è¡¨ç»„ä»¶ä»144å¢åŠ åˆ°320ï¼ˆ+176ä¸ªç»„ä»¶ï¼‰
5. æ–°å¢erlangè¯­è¨€æ”¯æŒ

### ğŸ“Š å½“å‰çŠ¶æ€

**é¡¹ç›®è¯­è¨€åˆ†å¸ƒ**ï¼ˆ19ä¸ªé¡¹ç›®ï¼‰ï¼š
- Java: 3
- Python: 3
- PHP: 2
- Ruby: 1
- Rust: 3
- JavaScript: 3
- Erlang: 3
- C: 1
- Other: 1ï¼ˆæ— æ³•è¯†åˆ«ï¼‰

**ç™½åå•ç»„ä»¶åˆ†å¸ƒ**ï¼ˆ320ä¸ªç»„ä»¶ï¼‰ï¼š
- Java: 164 (51%)
- Python: 66 (21%)
- Ruby: 74 (23%)
- PHP: 14 (4%)
- Erlang: 2 (1%)

### ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç«‹å³æ‰§è¡Œ**ï¼š
```bash
# è§¦å‘æ¼æ´æ£€æµ‹ä»»åŠ¡ï¼ˆåœ¨XXL-JOBç®¡ç†ç•Œé¢ï¼‰
# 1. è®¿é—® http://localhost:8080/xxl-job-admin
# 2. æ‰§è¡Œä»»åŠ¡ï¼šgithubVulnerabilityFetchJob æˆ– avdVulnerabilityFetchJob

# ç­‰å¾…60ç§’åæŸ¥çœ‹ç»“æœ
mysql -u root -p15256785749rly kulin -e "
SELECT language, COUNT(*) as vuln_count
FROM vulnerability
WHERE is_delete = 0
GROUP BY language;"
```

**ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ç«¯åˆ°ç«¯çš„æ¼æ´æ£€æµ‹æµ‹è¯•ï¼** âœ…

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-11-14
**ç”Ÿæˆå·¥å…·**: Claude Code
