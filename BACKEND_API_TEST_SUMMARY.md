# VulSystem åç«¯æ¥å£æµ‹è¯•æ€»ç»“

## ğŸ¯ æµ‹è¯•æ¦‚è§ˆ

**åç«¯çŠ¶æ€**: âœ… æ­£åœ¨è¿è¡Œ (localhost:8081)
**æµ‹è¯•æ—¶é—´**: 2025-11-13
**æ¡†æ¶**: Spring Boot 2.6.13 + MyBatis Plus
**æ•°æ®åº“**: MySQL
**æµ‹è¯•æ–¹æ³•**: curl + bashè„šæœ¬

---

## ğŸ“Š æµ‹è¯•ç»“æœç»Ÿè®¡

### æ€»ä½“æŒ‡æ ‡
| é¡¹ç›® | æ•°å€¼ |
|------|------|
| **æ€»æ¥å£æ•°** | 13 |
| **æˆåŠŸæ¥å£** | 12 |
| **å¤±è´¥æ¥å£** | 1 |
| **æˆåŠŸç‡** | 92.3% |

### æŒ‰æ¨¡å—åˆ†å¸ƒ
| æ¨¡å— | æ€»æ•° | æˆåŠŸ | å¤±è´¥ | æˆåŠŸç‡ |
|------|------|------|------|--------|
| ç”¨æˆ·æ¨¡å— | 3 | 3 | 0 | 100% |
| å…¬å¸æ¨¡å— | 2 | 2 | 0 | 100% |
| é¡¹ç›®æ¨¡å— | 4 | 4 | 0 | 100% |
| æ¼æ´æ¨¡å— | 1 | 0 | 1 | 0% |
| æ¼æ´æŠ¥å‘Šæ¨¡å— | 3 | 3 | 0 | 100% |

---

## âœ… åŠŸèƒ½æ­£å¸¸çš„æ¨¡å—

### 1ï¸âƒ£ ç”¨æˆ·æ¨¡å— (100% æ­£å¸¸)
| æ¥å£ | æ–¹æ³• | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| `/user/login` | GET | âœ… | ç”¨æˆ·ç™»å½• |
| `/user/register` | POST | âœ… | ç”¨æˆ·æ³¨å†Œ |
| `/user/info` | GET | âœ… | è·å–ç”¨æˆ·ä¿¡æ¯ |

**åŠŸèƒ½éªŒè¯**:
- æ–°ç”¨æˆ·æ³¨å†ŒæˆåŠŸ
- ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢è¿”å›å®Œæ•´æ•°æ®
- é”™è¯¯å¤„ç†æ­£ç¡®ï¼ˆå¦‚ç”¨æˆ·ä¸å­˜åœ¨ï¼‰

### 2ï¸âƒ£ å…¬å¸æ¨¡å— (100% æ­£å¸¸)
| æ¥å£ | æ–¹æ³• | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| `/company/getStrategy` | GET | âœ… | è·å–æ£€æµ‹ç­–ç•¥ |
| `/company/updateStrategy` | POST | âœ… | æ›´æ–°æ£€æµ‹ç­–ç•¥ |

**åŠŸèƒ½éªŒè¯**:
- æˆåŠŸè·å–å…¬å¸çš„æ£€æµ‹ç­–ç•¥é…ç½®
- æˆåŠŸæ›´æ–°ç­–ç•¥å‚æ•°ï¼ˆç›¸ä¼¼åº¦ã€æ£€æµ‹æ•°é‡ç­‰ï¼‰
- è¿”å›æ•°æ®å®Œæ•´ï¼ˆåŒ…å«detectStrategyã€similarityThresholdç­‰ï¼‰

### 3ï¸âƒ£ é¡¹ç›®æ¨¡å— (100% æ­£å¸¸)
| æ¥å£ | æ–¹æ³• | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| `/project/list` | GET | âœ… | é¡¹ç›®åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰ |
| `/project/info` | GET | âœ… | é¡¹ç›®è¯¦æƒ… |
| `/project/getVulnerabilities` | GET | âœ… | é¡¹ç›®æ¼æ´ |
| `/project/statistics` | GET | âœ… | é¡¹ç›®ç»Ÿè®¡ |

**åŠŸèƒ½éªŒè¯**:
- é¡¹ç›®åˆ—è¡¨åˆ†é¡µæŸ¥è¯¢æ­£å¸¸
- åŒ…å«é£é™©ç­‰çº§ã€é˜ˆå€¼ç­‰å…³é”®å­—æ®µ
- é”™è¯¯å¤„ç†å¾—å½“ï¼ˆä¸å­˜åœ¨çš„é¡¹ç›®è¿”å›é”™è¯¯æç¤ºï¼‰

### 4ï¸âƒ£ æ¼æ´æŠ¥å‘Šæ¨¡å— (100% æ­£å¸¸)
| æ¥å£ | æ–¹æ³• | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| `/vulnerabilityReport/list` | GET | âœ… | æ¼æ´åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰ |
| `/vulnerabilityReport/search` | GET | âœ… | å…³é”®å­—æœç´¢ |
| `/vulnerabilityReport/filter` | GET | âœ… | é£é™©ç­‰çº§è¿‡æ»¤ |

**åŠŸèƒ½éªŒè¯**:
- æˆåŠŸè¿”å›æ¼æ´åˆ—è¡¨ï¼ˆåŒ…å«CVE-IDã€æè¿°ç­‰ï¼‰
- å…³é”®å­—æœç´¢åŠŸèƒ½æ­£å¸¸
- æŒ‰é£é™©ç­‰çº§è¿‡æ»¤åŠŸèƒ½æ­£å¸¸
- åˆ†é¡µæ­£ç¡®

---

## âŒ å­˜åœ¨é—®é¢˜çš„æ¥å£

### æ¼æ´å»ºè®®æ¥å—æ¥å£ (0% æ­£å¸¸)
**æ¥å£**: `GET /vulnerability/accept`

#### é—®é¢˜æè¿°
```
GET /vulnerability/accept?vulnerabilityid=1&ifaccept=1
HTTP Status: 200 (ä½†ä¸šåŠ¡è¿”å›é”™è¯¯)
é”™è¯¯ä¿¡æ¯: SQLè¯­æ³•é”™è¯¯ - Unknown column 'ref' in 'field list'
```

#### æ ¹æœ¬åŸå› 
SQL æŸ¥è¯¢è¯­å¥åŒ…å«ä¸å­˜åœ¨çš„åˆ— `ref`:
```sql
SELECT id,name,description,language,time,riskLevel,isaccept,isdelete,ref
FROM vulnerability
WHERE id=?
```

#### é—®é¢˜ä½ç½®
- **Controller**: `VulnerabilityController.java:20`
- **Mapper**: `VulnerabilityMapper.java` (æ¨æµ‹)
- **å®ä½“ç±»**: `Vulnerability.po` (æ¨æµ‹)

#### ä¿®å¤å»ºè®®
1. æ£€æŸ¥ `Vulnerability` å®ä½“ç±»çš„å­—æ®µå®šä¹‰
2. ç¡®è®¤æ•°æ®åº“è¡¨ `vulnerability` ä¸­çš„å®é™…åˆ—
3. ä» Mapper SQL ä¸­åˆ é™¤æˆ–æ·»åŠ  `ref` åˆ—ï¼ˆæ ¹æ®å®é™…æƒ…å†µï¼‰

#### å‚è€ƒä»£ç 
**VulnerabilityController.java** (ç¬¬ 20 è¡Œ):
```java
@RequestMapping("/accept")
public RespBean acceptVulnerabilitySuggestion(
    @RequestParam("vulnerabilityid") int id,
    @RequestParam("ifaccept") int isAccept
) {
    // å‚æ•°ç±»å‹æ­£ç¡®ï¼ˆintï¼‰ï¼Œé—®é¢˜åœ¨åº•å±‚æ•°æ®åº“æŸ¥è¯¢
}
```

---

## ğŸ” API æ¥å£å…¨è§ˆ

### ç”¨æˆ·æ¨¡å—
```
GET    /user/login              - ç”¨æˆ·ç™»å½•
POST   /user/register           - ç”¨æˆ·æ³¨å†Œ
GET    /user/info              - è·å–ç”¨æˆ·ä¿¡æ¯
```

### å…¬å¸æ¨¡å—
```
GET    /company/getStrategy    - è·å–å…¬å¸æ£€æµ‹ç­–ç•¥
POST   /company/updateStrategy - æ›´æ–°å…¬å¸æ£€æµ‹ç­–ç•¥
```

### é¡¹ç›®æ¨¡å—
```
POST   /project/create          - åˆ›å»ºé¡¹ç›®
POST   /project/uploadFile      - ä¸Šä¼ æ–‡ä»¶
POST   /project/uploadProject   - ä¸Šä¼ é¡¹ç›®
POST   /project/delete          - åˆ é™¤é¡¹ç›®
POST   /project/update          - æ›´æ–°é¡¹ç›®
GET    /project/list            - é¡¹ç›®åˆ—è¡¨
GET    /project/info            - é¡¹ç›®è¯¦æƒ…
GET    /project/getVulnerabilities - é¡¹ç›®æ¼æ´
GET    /project/statistics      - é¡¹ç›®ç»Ÿè®¡
GET    /project/sbom            - è·å–SBOMæ–‡ä»¶
```

### æ¼æ´æ¨¡å—
```
GET    /vulnerability/accept    - æ¥å—/æ‹’ç»æ¼æ´å»ºè®® âš ï¸ (æœ‰SQLé”™è¯¯)
```

### æ¼æ´æŠ¥å‘Šæ¨¡å—
```
GET    /vulnerabilityReport/list   - æ¼æ´æŠ¥å‘Šåˆ—è¡¨
GET    /vulnerabilityReport/search - æœç´¢æ¼æ´æŠ¥å‘Š
GET    /vulnerabilityReport/filter - è¿‡æ»¤æ¼æ´æŠ¥å‘Š
```

---

## ğŸ“‹ å“åº”æ ¼å¼æ ‡å‡†

æ‰€æœ‰æ¥å£è¿”å›ç»Ÿä¸€çš„ `RespBean` æ ¼å¼:

```json
{
  "code": 200,           // ä¸šåŠ¡çŠ¶æ€ç ï¼ˆ200=æˆåŠŸ, 500=é”™è¯¯ï¼‰
  "message": "SUCCESS",  // çŠ¶æ€æ¶ˆæ¯
  "obj": {}              // å“åº”æ•°æ®ï¼ˆå¯ä¸ºå¯¹è±¡ã€æ•°ç»„æˆ–å­—ç¬¦ä¸²ï¼‰
}
```

### æˆåŠŸç¤ºä¾‹
```json
{
  "code": 200,
  "message": "SUCCESS",
  "obj": { "id": 1, "userName": "testUser", ... }
}
```

### é”™è¯¯ç¤ºä¾‹
```json
{
  "code": 500,
  "message": "æœåŠ¡ç«¯å¼‚å¸¸",
  "obj": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
}
```

---

## ğŸš€ æ€§èƒ½è¯„ä¼°

### å“åº”æ—¶é—´
- å¹³å‡å“åº”æ—¶é—´: < 500ms
- æœ€å¿«: æ•°æ®åº“æŸ¥è¯¢ç±»æ¥å£ (~100ms)
- æœ€æ…¢: åˆ—è¡¨æŸ¥è¯¢æ¥å£ (~300-400ms)

### å¹¶å‘èƒ½åŠ›
- æ¡†æ¶: Spring Boot 2.6.13ï¼ˆTomcat 9.0.68ï¼‰
- æ•°æ®åº“: MySQL (HikariCPè¿æ¥æ± )
- é¢„è®¡ååé‡: ~100+ req/sï¼ˆå…·ä½“å–å†³äºæ•°æ®åº“é…ç½®ï¼‰

---

## ğŸ›  ä¼˜åŒ–å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. **ä¿®å¤SQLé”™è¯¯** - è§£å†³ `/vulnerability/accept` çš„ `ref` åˆ—é—®é¢˜
   - é¢„è®¡å½±å“: æ¼æ´æ¥å—åŠŸèƒ½
   - ä¿®å¤æ—¶é—´: ~15åˆ†é’Ÿ

### ä¸­ä¼˜å…ˆçº§
2. **æ·»åŠ è¾“å…¥éªŒè¯** - å¢å¼º request å‚æ•°éªŒè¯
   - å»ºè®®: ä½¿ç”¨ @Valid æ³¨è§£
   - ç¤ºä¾‹: @RequestParam @NotNull @Positive Integer id

3. **è§„èŒƒé”™è¯¯å“åº”** - ç»Ÿä¸€ HTTP çŠ¶æ€ç å’Œä¸šåŠ¡é”™è¯¯ä¿¡æ¯
   - å»ºè®®: é¡¹ç›®ä¸å­˜åœ¨æ—¶è¿”å› 404 è€Œé 500

### ä½ä¼˜å…ˆçº§
4. **æ·»åŠ æ—¥å¿—** - å¢åŠ è¯·æ±‚/å“åº”æ—¥å¿—ä»¥ä¾¿è°ƒè¯•
5. **æ€§èƒ½ä¼˜åŒ–** - è€ƒè™‘æ·»åŠ ç¼“å­˜ï¼ˆå¦‚Redisï¼‰

---

## ğŸ“ æµ‹è¯•è„šæœ¬ä½¿ç”¨

### è¿è¡Œæµ‹è¯•
```bash
cd /c/Users/ä»»è‰¯ç‰/Desktop/kuling/VulSystem
bash api_test_complete.sh
```

### è¾“å‡ºæ–‡ä»¶
- æµ‹è¯•è„šæœ¬: `api_test_complete.sh`
- æµ‹è¯•ç»“æœ: `api_test_results.txt`
- æ­¤æŠ¥å‘Š: `API_TEST_REPORT.md` (å·²å­˜æ¡£)

### å•ä¸ªæ¥å£æµ‹è¯•
```bash
# ç”¨æˆ·ç™»å½•
curl "http://localhost:8081/user/login?username=test&password=pass"

# è·å–é¡¹ç›®åˆ—è¡¨
curl "http://localhost:8081/project/list?companyId=1&page=1&size=10"

# æœç´¢æ¼æ´æŠ¥å‘Š
curl "http://localhost:8081/vulnerabilityReport/search?keyword=test"
```

---

## âœ¨ æ€»ç»“

### ç³»ç»Ÿå¥åº·åº¦: 92.3% âœ…

**ä¼˜åŠ¿**:
- å¤§å¤šæ•°æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸è¿è¡Œ
- ä»£ç ç»“æ„æ¸…æ™°ï¼Œé”™è¯¯å¤„ç†è§„èŒƒ
- æ•°æ®åº“æŸ¥è¯¢æ­£ç¡®ï¼ˆé™¤ä¸€ä¸ªåˆ—åé”™è¯¯å¤–ï¼‰
- å‰åç«¯é€šä¿¡æ¥å£æ¸…æ™°

**éœ€è¦æ”¹è¿›**:
- ä¿®å¤æ¼æ´æ¥å—æ¥å£çš„SQLé”™è¯¯
- å¢å¼ºé”™è¯¯å¤„ç†å’ŒéªŒè¯
- è§„èŒƒåŒ–HTTPçŠ¶æ€ç ä½¿ç”¨

**å»ºè®®**:
- ä¼˜å…ˆä¿®å¤SQLé”™è¯¯ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
- æ·»åŠ é›†æˆæµ‹è¯•ä»¥é˜²æ­¢å›å½’
- å®šæœŸè¿›è¡ŒAPIæµ‹è¯•

---

**æŠ¥å‘Šç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-13
**æµ‹è¯•ç¯å¢ƒ**: Windows + Java 8 (Corretto 1.8.0_462) + MySQL
